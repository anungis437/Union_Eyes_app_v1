import { Request, Response, NextFunction } from 'express';
import { SecurityContext, PermissionCheck } from '../types/index';
import { AuthenticationService } from '../services/authentication.service';
import { AuthorizationService } from '../services/authorization.service';
import { EnterpriseSSOService } from '../services/enterprise-sso.service';
import { EnterpriseRBACService } from '../services/enterprise-rbac.service';
import { EnterpriseMFAService } from '../services/enterprise-mfa.service';
import { EnterpriseAuditService } from '../services/enterprise-audit.service';
import { type SecurityConfig } from './enterprise-security.middleware';
declare global {
    namespace Express {
        interface Request {
            security?: SecurityContext;
            user?: {
                id: string;
                email: string;
                name: string;
                tenantId?: string;
                organizationId?: string;
                roles: string[];
                permissions: string[];
                mfaVerified: boolean;
                sessionId: string;
                riskScore: number;
            };
        }
    }
}
export interface SecurityMiddlewareConfig {
    authenticationService: AuthenticationService;
    authorizationService: AuthorizationService;
    ssoService?: EnterpriseSSOService;
    rbacService?: EnterpriseRBACService;
    mfaService?: EnterpriseMFAService;
    auditService?: EnterpriseAuditService;
    rateLimitConfig?: any;
    corsConfig?: any;
    securityConfig?: Partial<SecurityConfig>;
    enableEnterprise?: boolean;
}
export declare class SecurityMiddleware {
    private authService;
    private authzService;
    private ssoService?;
    private rbacService?;
    private mfaService?;
    private auditService?;
    private enterpriseMiddleware?;
    private logger;
    private config;
    constructor(config: SecurityMiddlewareConfig);
    /**
     * Initialize enterprise security middleware
     */
    private initializeEnterpriseMiddleware;
    /**
     * Check if enterprise features are enabled
     */
    private isEnterpriseEnabled;
    /**
     * Get the complete middleware stack
     */
    getMiddlewareStack(): (((req: import("http").IncomingMessage, res: import("http").ServerResponse, next: (err?: unknown) => void) => void) | import("express-rate-limit").RateLimitRequestHandler | ((req: import("./enterprise-security.middleware").AuthenticatedRequest, res: Response, next: NextFunction) => Promise<void | Response<any, Record<string, any>>>))[] | (import("express-rate-limit").RateLimitRequestHandler | ((error: any, req: Request, res: Response, next: NextFunction) => Response<any, Record<string, any>> | undefined) | ((req: Request, res: Response, next: NextFunction) => void))[];
    /**
     * Security headers middleware using Helmet
     */
    securityHeaders(): (req: import("http").IncomingMessage, res: import("http").ServerResponse, next: (err?: unknown) => void) => void;
    /**
     * Rate limiting middleware
     */
    rateLimit(options?: any): import("express-rate-limit").RateLimitRequestHandler;
    /**
     * Strict rate limiting for authentication endpoints
     */
    authRateLimit(): import("express-rate-limit").RateLimitRequestHandler;
    /**
     * Authentication middleware
     */
    authenticate(options?: {
        optional?: boolean;
    }): (req: Request, res: Response, next: NextFunction) => Promise<void | Response<any, Record<string, any>>>;
    /**
     * Authorization middleware
     */
    authorize(permissionCheck: PermissionCheck): (req: Request, res: Response, next: NextFunction) => Promise<Response<any, Record<string, any>> | undefined>;
    /**
     * Organization access middleware
     */
    requireOrganizationAccess(organizationIdParam?: string): (req: Request, res: Response, next: NextFunction) => Promise<Response<any, Record<string, any>> | undefined>;
    /**
     * Input validation middleware
     */
    validateInput(validations: any[]): any[];
    /**
     * CORS middleware with security considerations
     */
    cors(options?: any): (req: Request, res: Response, next: NextFunction) => Response<any, Record<string, any>> | undefined;
    /**
     * Error handling middleware
     */
    errorHandler(): (error: any, req: Request, res: Response, next: NextFunction) => Response<any, Record<string, any>> | undefined;
    /**
     * Request logging middleware
     */
    requestLogger(): (req: Request, res: Response, next: NextFunction) => void;
}
export declare const ValidationSchemas: {
    email: import("express-validator").ValidationChain;
    password: import("express-validator").ValidationChain;
    uuid: (field: string) => import("express-validator").ValidationChain;
    requiredString: (field: string) => import("express-validator").ValidationChain;
};
//# sourceMappingURL=security.middleware.d.ts.map