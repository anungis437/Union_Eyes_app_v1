"use strict";
// CourtLens Security Event Service
// Centralized security event logging and monitoring
Object.defineProperty(exports, "__esModule", { value: true });
exports.SecurityEventService = void 0;
const supabase_js_1 = require("@supabase/supabase-js");
const types_1 = require("../types");
class SecurityEventService {
    constructor(supabaseUrl, supabaseKey) {
        if (supabaseUrl && supabaseKey) {
            this.supabase = (0, supabase_js_1.createClient)(supabaseUrl, supabaseKey);
        }
        else {
            // Use environment variables if not provided
            this.supabase = (0, supabase_js_1.createClient)(process.env.SUPABASE_URL || '', process.env.SUPABASE_SERVICE_ROLE_KEY || '');
        }
    }
    async logEvent(event) {
        try {
            const { error } = await this.supabase
                .from('security_events')
                .insert([event]);
            if (error) {
                console.error('Failed to log security event:', error);
            }
            // For high/critical risk events, trigger immediate alerts
            if (event.riskLevel === types_1.RiskLevel.HIGH || event.riskLevel === types_1.RiskLevel.CRITICAL) {
                await this.triggerAlert(event);
            }
        }
        catch (error) {
            console.error('Security event logging failed:', error);
        }
    }
    async triggerAlert(event) {
        // TODO: Implement alerting mechanism (email, Slack, etc.)
        console.log('SECURITY ALERT:', event);
    }
}
exports.SecurityEventService = SecurityEventService;
//# sourceMappingURL=security-event.service.js.map